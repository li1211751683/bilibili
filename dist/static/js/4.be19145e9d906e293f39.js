webpackJsonp([4],{NRmB:function(t,e){},UbIS:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("Xxa5"),i=n.n(s),a=n("exGp"),c=n.n(a),o=n("DIWV"),r=n("jJEn"),m={props:["dataLength"],data:function(){return{myuser:null,comcontent:""}},methods:{myUserinfo:function(){var t=this;return c()(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/user/"+localStorage.getItem("id"));case 2:n=e.sent,t.myuser=n.data[0];case 4:case"end":return e.stop()}},e,t)}))()},cmmentPublish:function(){this.myuser||localStorage.getItem("token")||localStorage.getItem("id")?(this.$emit("Postcomment",this.comcontent),this.comcontent=""):this.$msg.fail("请先登录")},focusIpt:function(){this.$refs.Postipt.focus()}},created:function(){localStorage.getItem("token")&&this.myUserinfo()}},l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment"},[n("p",{staticClass:"comment-title"},[n("span",[t._v("评论")]),t._v(" "),n("span",[t._v("("+t._s(t.dataLength)+")")])]),t._v(" "),n("div",{staticClass:"commentMyinfo"},[t.myuser?n("img",{attrs:{src:t.myuser.user_img,alt:""}}):t._e(),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.comcontent,expression:"comcontent"}],ref:"Postipt",attrs:{type:"text",placeholder:"说点什么吧"},domProps:{value:t.comcontent},on:{input:function(e){e.target.composing||(t.comcontent=e.target.value)}}}),t._v(" "),n("button",{on:{click:t.cmmentPublish}},[t._v("发表")])])])},staticRenderFns:[]};var u=n("VU/8")(m,l,!1,function(t){n("WFuR")},null,null).exports,d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"commentitems"},t._l(t.commentChild,function(e,i){return s("div",{key:i,staticClass:"commentItem"},[s("div",{staticClass:"userImg"},[e.userinfo&&e.userinfo.user_img?s("img",{attrs:{src:e.userinfo.user_img,alt:""}}):s("img",{attrs:{src:n("p2pt"),alt:""}}),t._v(" "),s("p",[e.userinfo?s("span",[t._v(t._s(e.userinfo.name))]):s("span",[t._v("此用户无姓名")]),t._v(" "),s("span",[t._v(t._s(e.comment_date))])])]),t._v(" "),s("div",{staticClass:"commentContent"},[t.temp?s("div",[t._v("\n        回复\n        "),s("span",{staticStyle:{color:"#478ef0"}},[t._v(t._s(e.parent_user_info.name))]),t._v("\n        :"+t._s(e.comment_content)),s("span",{staticClass:"publish",on:{click:function(n){return t.PostItemcomment(e.comment_id)}}},[t._v("回复")])]):s("div",[t._v("\n        "+t._s(e.comment_content)+"\n        "),s("span",{staticClass:"publish",on:{click:function(n){return t.PostItemcomment(e.comment_id)}}},[t._v("回复")])])]),t._v(" "),s("commentchild-item",{attrs:{commentChild:e.child,temp:!0},on:{postChild:t.postChild}})],1)}),0)},staticRenderFns:[]};var v={components:{commentItem:n("VU/8")({name:"commentchildItem",props:["commentChild","temp"],methods:{PostItemcomment:function(t){this.$emit("postChild",t),this.$emit("PostPublish",t)},postChild:function(t){this.PostItemcomment(t),this.$emit("PostPublish",t)}}},d,!1,function(t){n("xNma")},null,null).exports},data:function(){return{commentList:null}},created:function(){this.commentData()},methods:{commentData:function(){var t=this;return c()(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/comment/"+t.$route.params.id);case 2:(n=e.sent).data&&t.$emit("lengthselect",n.data.length),t.commentList=t.changeCommentData(n.data);case 5:case"end":return e.stop()}},e,t)}))()},changeCommentData:function(t){return function e(n){for(var s=[],i=0;i<t.length;i++)t[i].parent_id==n&&(s.push(t[i]),t[i].child=e(t[i].comment_id));return s}(null)},publishClick:function(t){this.$emit("publishClick",t)}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"commentParent"},t._l(t.commentList,function(e,i){return s("div",{key:i},[s("div",{staticClass:"commentItem"},[s("div",{staticClass:"userImg"},[e.userinfo&&e.userinfo.user_img?s("img",{attrs:{src:e.userinfo.user_img,alt:""}}):s("img",{attrs:{src:n("p2pt"),alt:""}})]),t._v(" "),s("div",{staticClass:"commentContent"},[s("p",[e.userinfo?s("span",[t._v(t._s(e.userinfo.name))]):s("span",[t._v("此用户无姓名")]),t._v(" "),s("span",[t._v(t._s(e.comment_date))])]),t._v(" "),s("div",[t._v("\n          "+t._s(e.comment_content)+"\n          "),s("span",{staticClass:"publishs",on:{click:function(n){return t.publishClick(e.comment_id)}}},[t._v("回复")])])])]),t._v(" "),s("div",{staticStyle:{"padding-left":"8.333vw"}},[s("comment-item",{attrs:{commentChild:e.child},on:{PostPublish:t.publishClick}})],1)])}),0)},staticRenderFns:[]};var _=n("VU/8")(v,p,!1,function(t){n("NRmB")},null,null).exports,f={components:{NavBar:o.a,cover:r.a,commentTitle:u,comment:_},data:function(){return{model:null,commendList:null,lens:null,Postcom:{comment_content:"",comment_date:"",parent_id:null,article_id:null},collectionActive:null,subscritionActive:null}},created:function(){this.articleitemData(),this.commendData(),this.collectionInit()},methods:{articleitemData:function(){var t=this;return c()(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/article/"+t.$route.params.id);case 2:n=e.sent,t.model=n.data[0],t.model&&t.subscritionInit();case 5:case"end":return e.stop()}},e,t)}))()},commendData:function(){var t=this;return c()(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/commend");case 2:n=e.sent,t.commendList=n.data;case 4:case"end":return e.stop()}},e,t)}))()},PostChildClick:function(t){this.Postcom.parent_id=t,this.$refs.commentIpt.focusIpt()},PostSuccess:function(t){var e=this;return c()(i.a.mark(function n(){var s,a,c,o,r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=new Date,a=s.getMonth()+1,c=s.getDate(),a<10&&(a="0"+a),c<10&&(c="0"+c),o=a+"-"+c,e.Postcom.comment_content=t,e.Postcom.comment_date=o,e.Postcom.article_id=e.$route.params.id,n.next=11,e.$http.post("/comment_post/"+localStorage.getItem("id"),e.Postcom);case 11:r=n.sent,e.$refs.commentPulish.commentData(),e.Postcom.parent_id=null,200==r.status&&e.$msg.fail("评论发表成功");case 15:case"end":return n.stop()}},n,e)}))()},collectionClick:function(){var t=this;return c()(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("token")){e.next=6;break}return e.next=3,t.$http.post("/collection/"+localStorage.getItem("id"),{article_id:t.$route.params.id});case 3:"收藏成功"==(n=e.sent).data.msg?t.collectionActive=!0:t.collectionActive=!1,t.$msg.fail(n.data.msg);case 6:case"end":return e.stop()}},e,t)}))()},collectionInit:function(){var t=this;return c()(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("token")){e.next=5;break}return e.next=3,t.$http.get("/collection/"+localStorage.getItem("id"),{params:{article_id:t.$route.params.id}});case 3:n=e.sent,t.collectionActive=n.data.success;case 5:case"end":return e.stop()}},e,t)}))()},subscriptClick:function(){var t=this;return c()(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("token")){e.next=6;break}return e.next=3,t.$http.post("/sub_scription/"+localStorage.getItem("id"),{sub_id:t.model.userid});case 3:"关注成功"==(n=e.sent).data.msg?t.subscritionActive=!0:t.subscritionActive=!1,t.$msg.fail(n.data.msg);case 6:case"end":return e.stop()}},e,t)}))()},subscritionInit:function(){var t=this;return c()(i.a.mark(function e(){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("token")){e.next=5;break}return e.next=3,t.$http.get("/sub_scription/"+localStorage.getItem("id"),{params:{sub_id:t.model.userid}});case 3:n=e.sent,t.subscritionActive=n.data.success;case 5:case"end":return e.stop()}},e,t)}))()}},watch:{$route:function(){this.articleitemData(),this.commendData(),this.collectionInit()}}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.model?n("div",[n("nav-bar"),t._v(" "),n("div",{staticClass:"detailinfo"},[n("div",{staticClass:"video"},[n("video",{attrs:{controls:"controls",src:t.model.content}})]),t._v(" "),n("div",{staticClass:"detailinfoText"},[n("div",[n("span",[t._v(t._s(t.model.category.title))]),t._v(" "),n("span",[t._v(t._s(t.model.name))])]),t._v(" "),n("div",[n("span",[t._v(t._s(t.model.userinfo.name))]),t._v(" "),n("span",[t._v("146.4万次观看")]),t._v(" "),n("span",[t._v("5281弹幕")]),t._v(" "),n("span",[t._v(t._s(t.model.date))])]),t._v(" "),n("div",[n("p",{class:{activeColor:t.collectionActive},on:{click:t.collectionClick}},[n("span",{staticClass:"icon-star-full"}),t._v(" "),n("span",[t._v("收藏")])]),t._v(" "),n("p",{class:{activeColor:t.subscritionActive},on:{click:t.subscriptClick}},[n("span",{staticClass:"icon-bubble"}),t._v(" "),n("span",[t._v("关注")])]),t._v(" "),t._m(0)])]),t._v(" "),n("div",{staticClass:"detailparent"},t._l(t.commendList,function(t,e){return n("cover",{key:e,staticClass:"detailitem",attrs:{detailitem:t}})}),1),t._v(" "),n("comment-title",{ref:"commentIpt",attrs:{dataLength:t.lens},on:{Postcomment:t.PostSuccess}}),t._v(" "),n("comment",{ref:"commentPulish",on:{lengthselect:function(e){return t.lens=e},publishClick:t.PostChildClick}})],1)],1):t._e()},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("span",{staticClass:"icon-redo2"}),this._v(" "),e("span",[this._v("分享")])])}]};var g=n("VU/8")(f,h,!1,function(t){n("b3lm")},null,null);e.default=g.exports},WFuR:function(t,e){},ZPlK:function(t,e){},b3lm:function(t,e){},jJEn:function(t,e,n){"use strict";var s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.detailitem?n("div",{on:{click:t.pathPush}},[n("div",{staticClass:"detailItem"},[n("div",{staticClass:"imgparent"},[n("img",{staticStyle:{width:"100%",height:"27.778vw"},attrs:{src:t.detailitem.img,alt:""}}),t._v(" "),n("div",{staticClass:"bottom"},[t._m(0),t._v(" "),n("div",{staticClass:"icon-file-text"},[n("span",{staticClass:"comment"},[t._v(t._s(t.detailitem.commentlen?t.detailitem.commentlen:66))])])])]),t._v(" "),n("p",[t._v(t._s(t.detailitem.name))])])]):t._e()},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"icon-play2"},[e("span",{staticClass:"video"},[this._v("1233")])])}]};var i=n("VU/8")({props:["detailitem"],methods:{pathPush:function(){this.$route.path!="/article/"+this.detailitem.id&&this.$router.push("/article/"+this.detailitem.id)}}},s,!1,function(t){n("ZPlK")},"data-v-4271df24",null);e.a=i.exports},xNma:function(t,e){}});
//# sourceMappingURL=4.be19145e9d906e293f39.js.map